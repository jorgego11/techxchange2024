"use strict";(self.webpackChunkswat_hub=self.webpackChunkswat_hub||[]).push([[4090],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||a;return n?o.createElement(h,i(i({ref:t},p),{},{components:n})):o.createElement(h,i({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:r,i[1]=l;for(var c=2;c<a;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4749:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var o=n(7462),r=(n(7294),n(3905));const a={title:"3. Set up the Netcool Connector",description:"Set up the Netcool Connector in AIOps",sidebar_position:3},i=void 0,l={unversionedId:"cloud-pak-aiops/netcool-lab/netcool-connector/index",id:"cloud-pak-aiops/netcool-lab/netcool-connector/index",title:"3. Set up the Netcool Connector",description:"Set up the Netcool Connector in AIOps",source:"@site/labs/cloud-pak-aiops/netcool-lab/3-netcool-connector/index.mdx",sourceDirName:"cloud-pak-aiops/netcool-lab/3-netcool-connector",slug:"/cloud-pak-aiops/netcool-lab/netcool-connector/",permalink:"/techxchange2024/labs/cloud-pak-aiops/netcool-lab/netcool-connector/",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"3. Set up the Netcool Connector",description:"Set up the Netcool Connector in AIOps",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"2. Lab Environment",permalink:"/techxchange2024/labs/cloud-pak-aiops/netcool-lab/lab-environment/"},next:{title:"4. Migrate a Netcool Custom Correlation to AIOps",permalink:"/techxchange2024/labs/cloud-pak-aiops/netcool-lab/migrate-custom-correlation/"}},s={},c=[{value:"3.1: Overview",id:"31-overview",level:2},{value:"3.2: Create a Netcool Connector instance",id:"32-create-a-netcool-connector-instance",level:2},{value:"Configure ObjectServer",id:"configure-objectserver",level:3},{value:"Add integration",id:"add-integration",level:3},{value:"Collect event data",id:"collect-event-data",level:3},{value:"3.3: Clear the events in Netcool/OMNIbus",id:"33-clear-the-events-in-netcoolomnibus",level:2},{value:"3.4: View the Alerts viewer",id:"34-view-the-alerts-viewer",level:2},{value:"3.5 Add custom fields to your view",id:"35-add-custom-fields-to-your-view",level:2}],p={toc:c},d="wrapper";function u(e){let{components:t,...a}=e;return(0,r.kt)(d,(0,o.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"31-overview"},"3.1: Overview"),(0,r.kt)("p",null,"In this section, you will create an instance of the Netcool Connector to connect to an existing Netcool/OMNIbus ObjectServer. Most AIOps deployments will include Netcool/OMNIbus components, including Probes and ObjectServers. Creating and configuring the Netcool Connector therefore is usually going to be a key part of any AIOps set-up."),(0,r.kt)("p",null,"This section will include the tasks of creating and configuring the Netcool Connector instance, adding custom Netcool/OMNIbus fields to the mapping, and then updating the Alerts viewer View to include a custom attribute."),(0,r.kt)("h2",{id:"32-create-a-netcool-connector-instance"},"3.2: Create a Netcool Connector instance"),(0,r.kt)("p",null,"Use the following steps to create an instance of the Netcool Connector:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"From the AIOps console, under ",(0,r.kt)("strong",{parentName:"li"},"Overview")," select ",(0,r.kt)("strong",{parentName:"li"},"Integrations")),(0,r.kt)("li",{parentName:"ul"},"Click the ",(0,r.kt)("strong",{parentName:"li"},"Add integration")," button to add a new integration"),(0,r.kt)("li",{parentName:"ul"},"Type ",(0,r.kt)("strong",{parentName:"li"},"Netcool")," into the Search bar"),(0,r.kt)("li",{parentName:"ul"},"Choose ",(0,r.kt)("strong",{parentName:"li"},"IBM Netcool Operations Insight ObjectServer")," and click ",(0,r.kt)("strong",{parentName:"li"},"Get started")," to create a new instance")),(0,r.kt)("h3",{id:"configure-objectserver"},"Configure ObjectServer"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"For the purpose of this lab, follow ",(0,r.kt)("strong",{parentName:"p"},"the instructions on this page")," instead of the steps described in the first page of the Netcool Connector.\nNote that the column ScopeID is already present in this ObjectServer. There is no need to add it again.")),(0,r.kt)("p",null,"The first part of the Netcool Connector instance configuration, is to prepare the ObjectServer to be connected to by AIOps.\nIn order to synchronize events in the Netcool ObjectServer with alerts in IBM Cloud Pak for AIOps, additional columns are required in the ObjectServer\nalerts.status table and an additional automation trigger must be installed to process closed alerts from IBM Cloud Pak for AIOps."),(0,r.kt)("p",null,"Open a command terminal by clicking on ",(0,r.kt)("strong",{parentName:"p"},"Activities")," tab in the top-left of the screen and select the ",(0,r.kt)("strong",{parentName:"p"},"Terminal")," icon. "),(0,r.kt)("p",null,"Lets create a ",(0,r.kt)("strong",{parentName:"p"},"lab")," ",(0,r.kt)("strong",{parentName:"p"},"folder")," for the upcoming files in the home directory and change to this new folder.\nRun the following command from the ",(0,r.kt)("strong",{parentName:"p"},"Terminal")," window:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cd; mkdir lab; cd lab\n")),(0,r.kt)("p",null,"We will create the file to contain the changes to the ObjectServer.\nCreate a file called ",(0,r.kt)("strong",{parentName:"p"},"add_trigger.sql")," by running the following command in the ",(0,r.kt)("strong",{parentName:"p"},"Terminal")," window to open the text editor\n, ",(0,r.kt)("strong",{parentName:"p"},"copy")," the script below (use the copy helper icon (top-right) for one-click copy), ",(0,r.kt)("strong",{parentName:"p"},"paste")," it into the text editor."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"gedit add_trigger.sql\n")),(0,r.kt)("p",null,"Copy and paste the following SQL into gedit:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"alter table alerts.status add column AIOpsAlertId varchar(64);\ngo\n\nalter table alerts.status add column AIOpsState varchar(16);\ngo\n\ncreate or replace trigger group NetcoolConnectorAutomation;\ngo\n\nalter trigger group NetcoolConnectorAutomation set enabled true;\ngo\n\nCREATE OR REPLACE TRIGGER netcool_connector_closed_alerts\nGROUP NetcoolConnectorAutomation\nPRIORITY 15\nCOMMENT 'Netcool Connector handle closed alerts in AIOps'\nAFTER UPDATE ON alerts.status\nFOR EACH ROW\nWHEN get_prop_value('ActingPrimary') %= 'TRUE' and\n    new.AIOpsState = 'closed'\nbegin\n\n    delete from alerts.status via new.Identifier;\nend;\ngo\n\n")),(0,r.kt)("p",null,"Click on the ",(0,r.kt)("strong",{parentName:"p"},"Save")," button in the text editor and ",(0,r.kt)("strong",{parentName:"p"},"close")," the editor window (click on the X). "),(0,r.kt)("p",null,"From the ",(0,r.kt)("strong",{parentName:"p"},"Terminal")," window, run the command below to connect to the primary ObjectServer, and execute the statements from the file you just created.\nThe response should be a sequence of ",(0,r.kt)("em",{parentName:"p"},"(0 rows affected)")," messages.  "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"export OMNIHOME=/opt/IBM/tivoli/netcool/omnibus\n$OMNIHOME/bin/nco_sql -server AGG_P -user root -password netcool < add_trigger.sql\n\n")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"In a production environment, this SQL would need to be added to both the primary and backup ObjectServers. In this lab however, we will only be using a single primary ObjectServer.")),(0,r.kt)("h3",{id:"add-integration"},"Add integration"),(0,r.kt)("p",null,"Click on the ",(0,r.kt)("strong",{parentName:"p"},"Next")," button.\nThis next step involves setting up the connection details for the target ObjectServer."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Name"),": the label you want to give this integration instance. For example: ",(0,r.kt)("em",{parentName:"li"},"netcoolConnector")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Description"),": an optional description to give this instance"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Deployment options"),": Choose a ",(0,r.kt)("strong",{parentName:"li"},"Local")," instance (deployed on the OpenShift cluster)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Admin username"),": enter ",(0,r.kt)("inlineCode",{parentName:"li"},"root")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Admin password"),": enter ",(0,r.kt)("inlineCode",{parentName:"li"},"netcool")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Filters"),": leave the contents of this box as it is"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Is TLS enabled?"),': leave set to "No"'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Primary ObjectServer Hostname"),": Enter: ",(0,r.kt)("inlineCode",{parentName:"li"},"10.100.1.200")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Port"),": enter: ",(0,r.kt)("inlineCode",{parentName:"li"},"4100")),(0,r.kt)("li",{parentName:"ul"},"Click the ",(0,r.kt)("strong",{parentName:"li"},"Test connection")," button and verify the connection is OK"),(0,r.kt)("li",{parentName:"ul"},"Leave the ",(0,r.kt)("strong",{parentName:"li"},"Backup ObjectServer")," section empty. ")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"In a production environment, we would enter the connection details for both the primary and backup ObjectServers. In this lab however, we will only be using a single primary ObjectServer.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Click the ",(0,r.kt)("strong",{parentName:"li"},"Next")," button to continue")),(0,r.kt)("h3",{id:"collect-event-data"},"Collect event data"),(0,r.kt)("p",null,"This final step is where you configure the mapping between ObjectServer fields and AIOps.\nLeave the ",(0,r.kt)("em",{parentName:"p"},"Enable data collection")," slider set (green). "),(0,r.kt)("p",null,"This ObjectServer has some custom fields. We will add a few Netcool custom fields to the mapping logic so they flow into AIOps.\nAdd this code section between the lines that start with ",(0,r.kt)("strong",{parentName:"p"},"expirySeconds")," and ",(0,r.kt)("strong",{parentName:"p"},"insights"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'    "details": {\n        "technology": alert.@Technology = "" ? undefined : alert.@Technology,\n        "businessService": alert.@BusinessService = "" ? undefined : alert.@BusinessService,\n        "componentType": alert.@ComponentType = "" ? undefined : alert.@ComponentType,\n        "alertOrigin": "OMNIbus"\n    },\n')),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Custom fields are added as sub-attributes of the ",(0,r.kt)("inlineCode",{parentName:"p"},"details")," attribute.\nIn the above example, we are mapping the Netcool/OMNIbus custom fields ",(0,r.kt)("inlineCode",{parentName:"p"},"@Technology"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"@BusinessService")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"@ComponentType")," to AIOps attributes,\nand hard-coding an additional attribute ",(0,r.kt)("inlineCode",{parentName:"p"},"details.alertOrigin"),' to "OMNIbus" for events coming through this integration.')),(0,r.kt)("p",null,"Click ",(0,r.kt)("strong",{parentName:"p"},"Done")," to save and create the Netcool Connector instance. Wait a couple of minutes until the ",(0,r.kt)("strong",{parentName:"p"},"Data Collection Status")," change to ",(0,r.kt)("strong",{parentName:"p"},"Running"),". "),(0,r.kt)("h2",{id:"33-clear-the-events-in-netcoolomnibus"},"3.3: Clear the events in Netcool/OMNIbus"),(0,r.kt)("p",null,"The Netcool Connector won't pick up any events that already exist in the ObjectServer. For this reason, it is important to clear the contents of the ObjectServer and start with a clean slate."),(0,r.kt)("p",null,"From the ",(0,r.kt)("strong",{parentName:"p"},"Terminal")," window, run the following command to log-in to the ObjectServer:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"$OMNIHOME/bin/nco_sql -server AGG_P -user root -password netcool\n")),(0,r.kt)("p",null,"Copy and paste the following SQL into the SQL prompt:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"delete from alerts.status;\ngo\n")),(0,r.kt)("p",null,"After running successfully this command you should see the ",(0,r.kt)("strong",{parentName:"p"},"(XX rows affected)")," message. "),(0,r.kt)("h2",{id:"34-view-the-alerts-viewer"},"3.4: View the Alerts viewer"),(0,r.kt)("p",null,"The final confirmation step is to inspect the ",(0,r.kt)("strong",{parentName:"p"},"Alerts viewer")," page."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Select ",(0,r.kt)("strong",{parentName:"li"},"Alerts")," from the main menu"),(0,r.kt)("li",{parentName:"ul"},"View the alerts coming through from Netcool/OMNIbus"),(0,r.kt)("li",{parentName:"ul"},"Double-click one of the alerts and inspect some of the attributes as defined in the Netcool Connector mapping")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(2718).Z,width:"3320",height:"1006"})),(0,r.kt)("h2",{id:"35-add-custom-fields-to-your-view"},"3.5 Add custom fields to your view"),(0,r.kt)("p",null,"Finally, you will add one custom-mapped field to your Alerts viewer.\nTo do this, click on the ",(0,r.kt)("strong",{parentName:"p"},"View configuration")," button shown below and select ",(0,r.kt)("strong",{parentName:"p"},"Manage selected view"),". "),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(2873).Z,width:"1024",height:"294"})),(0,r.kt)("p",null,"Type ",(0,r.kt)("em",{parentName:"p"},"technology")," in the ",(0,r.kt)("strong",{parentName:"p"},"Find and select columns")," box and check this field:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(9350).Z,width:"1892",height:"736"})),(0,r.kt)("p",null,"Next, drag the ",(0,r.kt)("em",{parentName:"p"},"details.technology")," field right under ",(0,r.kt)("em",{parentName:"p"},"summary")," so it is in the correct order in the View.\nFinally, set the column heading, justification, and size as you wish in the ",(0,r.kt)("strong",{parentName:"p"},"Configure selected columns")," box:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(1260).Z,width:"2134",height:"1046"})),(0,r.kt)("p",null,"Click ",(0,r.kt)("strong",{parentName:"p"},"Save")," to save your update and inspect the result in the Alerts viewer:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(6712).Z,width:"2288",height:"992"})))}u.isMDXComponent=!0},1260:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/add_field-0e2aa97a5c8ed0962f9bc65cba3398c4.png"},6712:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/alert_viewer_custom_field-0db8d2dfd6a3fdf6c3ae370e4b4fd8b3.png"},2718:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/alerts_viewer-c2923626047dcc08ee287608b4394ba7.png"},9350:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/search_field-f3b8f91796752020f1a94e1cdb8042c6.png"},2873:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/view-conf-button-f98873b236a133e032bb506cbba93532.png"}}]);